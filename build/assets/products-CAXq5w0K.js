import{b as De,r as s,j as e,ac as Z,a4 as N,ad as ee,T as f,I,L as Me,h as te,y as p,g as Oe,ae as re,af as Be,ag as Fe,d as Le,ah as _e}from"./index-WIu53gf0.js";import{C as Re,a as He,b as ae,c as i,d as ze,e as d,u as D,w as qe,F as Ge}from"./CTable-D-_VuHTg.js";const Ke=()=>{const M={borderRadius:"10px",height:"40px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgb(210, 134, 26, 0.5) !important",boxShadow:"0 0 0 0.25rem rgb(210, 134, 26, 0.2)"}},O={PaperProps:{style:{maxHeight:48*4.5+8},sx:{maxWidth:"calc(50% - 32px)","& .MuiMenuItem-root":{whiteSpace:"normal",wordBreak:"wordBreak",minHeight:"30px"},"& .MuiMenuItem-root:hover":{backgroundColor:"rgb(210, 134, 26, 0.1)"}}}},j={width:"100%","& .MuiOutlinedInput-root":{borderRadius:"10px",background:"var(--color-white)",height:"40px",padding:"3px 8px",transition:"all 0.3s",fontSize:"var(--text-xl)",border:"1px solid var(--color-gray-200)"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{outline:"none",border:"none"},"& .MuiOutlinedInput-input":{padding:0},"& .MuiInputBase-input":{color:"black",fontSize:"var(--text-lg)",border:"none"}},se={width:"100%","& .MuiOutlinedInput-root":{borderRadius:"10px",background:"var(--color-white)",minHeight:"40px",padding:"3px 8px",transition:"all 0.3s",fontSize:"var(--text-xl)",border:"1px solid var(--color-gray-200)"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{outline:"none",border:"none"},"& .MuiOutlinedInput-input":{padding:0},"& .MuiInputBase-input":{color:"black",fontSize:"var(--text-lg)",border:"none"}},{icons:u,setResProductAdmin:B,resProductAdmin:F,imgs:oe,setSelectPage:le,setResCategoriesAdmin:L,resCategoriesAdmin:ne}=De(),[o,ie]=s.useState(10),[l,y]=s.useState(1),[C,de]=s.useState(1),[c,ce]=s.useState(0),[xe,_]=s.useState(0),R=!1,[pe,H]=s.useState(null),g=async(t,r)=>{try{const a=await te(t,r);B(a.data)}catch(a){console.error("Lỗi khi gọi API getProductsPage",a),p.error("Lỗi khi gọi API getProductsPage")}},ue=async()=>{try{const t=await Oe();L(t.data)}catch(t){console.error("Lỗi khi gọi API getCategories",t),p.error("Lỗi khi gọi API getCategories"),L([])}};s.useEffect(()=>{g(0,o),y(1),le("Products"),ue()},[]);const ge=()=>{let t=1;l<C&&(t=l+1,y(t));const r=(t-1)*o+1;_(r),g(r,o)},he=()=>{let t=1;l>1&&(t=l-1,y(t));const r=(t-1)*o+1;_(r),g(r,o)},me=async t=>{try{(await _e(t)).data===!0&&(p.success("Delete success"),g(xe,o))}catch(r){console.error("Lỗi khi gọi API deltetProductById",r),p.error("Lỗi khi gọi API deltetProductById")}},be=t=>{me(t)},fe=t=>{t.currentTarget.onerror=null,t.currentTarget.src=oe.imgDefault},z=t=>new Date(t).toLocaleDateString("en-US"),je=t=>{B([]),ie(t.target.value),y(1),g(0,t.target.value)},ye=async()=>{try{const t=await re();if(t.data.length>0){ce(t.data.length);const r=Math.ceil(t.data.length/o);de(r)}}catch(t){console.error("Lỗi khi gọi API getProducts",t),p.error("Lỗi khi gọi API getProducts")}};s.useEffect(()=>{ye()},[]);const ve=async()=>{try{const t=await re();if(t.data.length>0){const r=D.json_to_sheet(t.data),a=D.book_new();D.book_append_sheet(a,r,"Products");const n=qe(a,{bookType:"xlsx",type:"array"}),E=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Ge.saveAs(E,`resProduct_${new Date().toISOString().slice(0,10)}.xlsx`)}else{p.error("There is no data to export to Excel!");return}}catch(t){console.error("Lỗi khi gọi API getProducts",t),p.error("Lỗi khi gọi API getProducts")}},[h,m]=s.useState(""),[v,b]=s.useState(0),[q,S]=s.useState(""),[G,A]=s.useState(0),[k,T]=s.useState([]),[we,U]=s.useState(!1),Pe=()=>{U(!0),m(""),b(0),S(""),A(0),T([])},$=()=>U(!1),Ne=t=>{A(Number(t.target.value))},Ie=t=>{const r=t.target.files;if(!r||r.length===0){P("Please choose at least one image");return}P("");const a=[];Array.from(r).forEach(n=>{a.push(new Promise((E,Ee)=>{const X=new FileReader;X.onload=Y=>{Y.target?.result?E(Y.target.result):Ee("Failed to read file")},X.readAsDataURL(n)}))}),Promise.all(a).then(n=>T(n)).catch(()=>x("Error reading one or more files"))},[w,x]=s.useState(""),[V,P]=s.useState(""),Ce=async t=>{try{const r=t.map(n=>Le(n));return await Promise.all(r)}catch(r){throw console.error("Upload multiple images failed:",r),r}},Se=async t=>{if(t.preventDefault(),x(""),P(""),!k.length){P("Please choose a representative photo");return}const r=await Ce(k),a=G;try{(await Be({title:h,price:v,description:q,categoryId:a,images:r})).data.title===h?($(),g(0,o),m(""),b(0),S(""),A(0),T([])):x("Add false")}catch(n){console.error("Error:",n),x("Add false")}},[Ae,W]=s.useState(!1),[K,J]=s.useState(void 0),ke=t=>{const r=F.find(a=>a.id===t);m(r?.title),b(r?.price),J(t),W(!0)},Q=()=>{W(!1),J(void 0)},Te=async t=>{t.preventDefault(),x("");try{(await Fe(K,{title:h,price:v})).data.id===K?(Q(),te(0,o)):x("Edit false")}catch(r){console.error("Error:",r),x("Edit false")}};return e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"min-h-[77.5vh] p-5 flex flex-col gap-5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:["Show",e.jsxs(Z,{value:o,onChange:je,className:" w-full",sx:M,MenuProps:O,children:[e.jsx(N,{value:10,children:"10"}),e.jsx(N,{value:15,children:"15"}),e.jsx(N,{value:20,children:"20"})]}),"products"]}),e.jsxs("div",{className:"ml-auto flex gap-2",children:[e.jsx("button",{className:"h-[40px] px-4 bg-orange-700 text-white shadow-lg rounded-[10px]",onClick:Pe,children:"Add Product"}),e.jsx(ee,{open:we,onClose:$,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:"absolute top-1/2 left-1/2 flex flex-col gap-4 -translate-x-1/2 -translate-y-1/2 w-1/3 bg-white shadow-lg rounded-[10px] p-5 ",children:[e.jsx("h3",{className:"text-orange-700 text-3xl text-center",children:"Add Product"}),e.jsx("div",{className:"w-full h-[2px] bg-gray-300"}),w&&e.jsx("div",{className:"bg-orange-700/20 border-[1px] border-orange-700/50 shadow-lg items-center mb-3 text-orange-700 text-lg py-1 rounded-[5px]",children:e.jsxs("p",{className:"text-center ",children:[w," !"]})}),e.jsx("form",{className:"space-y-4",onSubmit:Se,children:e.jsxs("div",{className:" flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"title",className:"block text-xl font-medium text-gray-700",children:"Title"}),e.jsx(f,{type:"text",required:!0,autoComplete:"title",placeholder:"title",name:"title",slotProps:{input:{startAdornment:e.jsx(I,{position:"start",children:u.iconTag})}},value:h,variant:"outlined",sx:j,onChange:t=>m(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"price",className:"block text-xl font-medium text-gray-700",children:"Price"}),e.jsx(f,{type:"number",required:!0,autoComplete:"price",placeholder:"Price",name:"price",slotProps:{input:{startAdornment:e.jsx(I,{position:"start",children:u.iconDollar})}},value:v,variant:"outlined",sx:j,onChange:t=>b(Number(t.target.value))})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"description",className:"block text-xl font-medium text-gray-700",children:"Description"}),e.jsx(f,{type:"text",required:!0,autoComplete:"description",placeholder:"Description",name:"description",value:q,variant:"outlined",sx:se,multiline:!0,minRows:2,maxRows:1/0,onChange:t=>S(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"category",className:"block text-xl font-medium text-gray-700",children:"Categpry"}),e.jsx(Z,{onChange:Ne,sx:M,MenuProps:O,value:G,children:ne.map(t=>e.jsx(N,{value:t.id.toString(),children:t.name},t.id))})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"image",className:"block text-xl font-medium text-gray-700",children:"Image"}),e.jsx("div",{className:"flex items-center w-full relative",children:e.jsxs("label",{htmlFor:"product_file",className:"div-upload-file h-[40px] flex gap-4 items-center justify-center border-[1px] rounded-[10px] border-dashed border-orange-700 cursor-pointer w-full",children:[e.jsx("svg",{className:"w-8 h-8 text-orange-700",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"})}),e.jsx("span",{className:"text-orange-700",children:"Upload file "}),e.jsx("input",{id:"product_file",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:Ie})]})}),V&&e.jsx("p",{style:{color:"red"},children:V}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10,marginTop:20},children:k.map((t,r)=>e.jsx("img",{src:t,alt:`preview-${r}`,style:{width:120,height:120,objectFit:"cover",borderRadius:8,border:"1px solid #ddd"}},r))})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-[10px] shadow-sm text-lg font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition duration-200",children:"Add"})})]})})]})}),e.jsx("button",{onClick:ve,className:"h-[40px] px-4 text-orange-700 border-[1px] shadow-lg border-orange-700 rounded-[10px]",children:"Export"})]})]}),e.jsxs("div",{className:"flex flex-col gap-5",children:[e.jsxs(Re,{bordered:!0,hover:!0,align:"middle",responsive:!0,className:"w-full border border-gray-300 ",style:{tableLayout:"fixed"},children:[e.jsx(He,{color:"light",children:e.jsxs(ae,{children:[e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[50px]",children:"ID"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[180px]",children:"Title"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[70px]",children:"Price"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 min-w-[120px]",children:"Description"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[120px]",children:"Category"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[70px]",children:"Image"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[100px]",children:"Creation At"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[100px]",children:"Update At"}),e.jsx(i,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[100px]",children:"Action"})]})}),e.jsx(ze,{children:F.map((t,r)=>e.jsxs(ae,{className:"table-body-row-mucluc",onClick:()=>{H(r)},onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),H(null))},style:{border:r===pe?"2px dashed rgb(92, 0, 0)":"",cursor:"pointer"},children:[e.jsx(d,{className:"text-center p-3 border-[1px] border-gray-200",children:t.id}),e.jsx(d,{className:"text-center p-3 border-[1px] border-gray-200",children:t.title}),e.jsxs(d,{className:"text-center p-3 border-[1px] border-gray-200",children:["$ ",t.price]}),e.jsx(d,{className:"text-center p-3 border-[1px] border-gray-200",children:t.description}),e.jsx(d,{className:"text-center p-3 border-[1px] border-gray-200",children:t.category.name}),e.jsx(d,{className:"p-3 border-[1px] border-gray-200 w-fit",children:e.jsx("div",{className:"grid gap-2 justify-center w-fit",children:t.images.map((a,n)=>e.jsx("img",{src:a,onError:fe,className:"w-12 h-12 object-cover rounded",alt:`category ${t.id}`},n))})}),e.jsx(d,{className:"text-center p-3 border-[1px] border-gray-200",children:z(t.creationAt)}),e.jsxs(d,{className:"text-center p-3 border-[1px] border-gray-200",children:[" ",z(t.updatedAt)]}),e.jsx(d,{className:"text-center p-3 border-[1px] border-gray-200",children:e.jsxs("div",{className:" flex justify-center gap-2 p-2",children:[e.jsx("button",{onClick:()=>{ke(t.id)},className:"px-2 py-2 bg-blue-500 text-white shadow-lg transition-all duration-300 ease rounded-[5px] hover:bg-blue-600 hover:shadow-xl",children:u.iconEdit}),e.jsx("button",{onClick:()=>{be(t.id)},className:"px-2 py-2 bg-red-500 text-white shadow-lg transition-all duration-300 ease rounded-[5px] hover:bg-red-600 hover:shadow-xl",children:u.iconDelete})]})})]},t.id||r))})]}),e.jsx(ee,{open:Ae,onClose:Q,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:"absolute top-1/2 left-1/2 flex flex-col gap-4 -translate-x-1/2 -translate-y-1/2 w-1/3 bg-white shadow-lg rounded-[10px] p-5 ",children:[e.jsx("h3",{className:"text-orange-700 text-3xl text-center",children:"Edit Product"}),e.jsx("div",{className:"w-full h-[2px] bg-gray-300"}),w&&e.jsx("div",{className:"bg-orange-700/20 border-[1px] border-orange-700/50 shadow-lg items-center mb-3 text-orange-700 text-lg py-1 rounded-[5px]",children:e.jsxs("p",{className:"text-center ",children:[w," !"]})}),e.jsx("form",{className:"space-y-4",onSubmit:Te,children:e.jsxs("div",{className:" flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"title",className:"block text-xl font-medium text-gray-700",children:"Title"}),e.jsx(f,{type:"text",required:!0,autoComplete:"title",placeholder:"title",name:"title",slotProps:{input:{startAdornment:e.jsx(I,{position:"start",children:u.iconTag})}},value:h,variant:"outlined",sx:j,onChange:t=>m(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"price",className:"block text-xl font-medium text-gray-700",children:"Price"}),e.jsx(f,{type:"number",required:!0,autoComplete:"price",placeholder:"Price",name:"price",slotProps:{input:{startAdornment:e.jsx(I,{position:"start",children:u.iconDollar})}},value:v,variant:"outlined",sx:j,onChange:t=>b(Number(t.target.value))})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-[10px] shadow-sm text-lg font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition duration-200",children:"Edit"})})]})})]})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"items-center",children:[c===0&&e.jsx("p",{children:"No items displayed"}),c>o*l&&e.jsxs("p",{children:["Showing ",(l-1)*o+1," to ",l*o," of ",c," categories"]}),c<=o*l&&c>0&&e.jsxs("p",{children:["Showing ",(l-1)*o+1," to ",c," of ",c," categories"]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:he,className:"h-[40px] px-4 bg-orange-700 text-white rounded-[10px] shadow-lg disabled:opacity-50",disabled:l===1||R,children:"Previous"}),e.jsxs("span",{className:"text-page font-medium",children:[l,"/",C]}),e.jsx("button",{onClick:ge,className:"h-[40px] px-4 bg-orange-700 text-white rounded-[10px] shadow-lg disabled:opacity-50",disabled:l===C||R,children:"Next"})]})]})]}),e.jsx(Me,{position:"top-right",autoClose:3e3})]})};export{Ke as default};
