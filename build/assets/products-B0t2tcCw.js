import{b as De,r as s,j as e,ac as ee,a4 as I,ad as te,T as f,I as C,L as Oe,h as re,y as u,g as Be,ae,af as Fe,ag as Le,d as _e,ah as Re}from"./index-CQ-Py5cF.js";import{u as D,w as He,F as ze}from"./FileSaver.min-mYdkh8MZ.js";import{C as qe,a as Ge,b as se,c as d,d as Ue,e as c}from"./CTable-BvTOw2Tf.js";const Qe=()=>{const O={borderRadius:"10px",height:"40px","&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgb(210, 134, 26, 0.5) !important",boxShadow:"0 0 0 0.25rem rgb(210, 134, 26, 0.2)"}},B={PaperProps:{style:{maxHeight:48*4.5+8},sx:{maxWidth:"calc(50% - 32px)","& .MuiMenuItem-root":{whiteSpace:"normal",wordBreak:"wordBreak",minHeight:"30px"},"& .MuiMenuItem-root:hover":{backgroundColor:"rgb(210, 134, 26, 0.1)"}}}},j={width:"100%","& .MuiOutlinedInput-root":{borderRadius:"10px",background:"var(--color-white)",height:"40px",padding:"3px 8px",transition:"all 0.3s",fontSize:"var(--text-xl)",border:"1px solid var(--color-gray-200)"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{outline:"none",border:"none"},"& .MuiOutlinedInput-input":{padding:0},"& .MuiInputBase-input":{color:"black",fontSize:"var(--text-lg)",border:"none"}},oe={width:"100%","& .MuiOutlinedInput-root":{borderRadius:"10px",background:"var(--color-white)",minHeight:"40px",padding:"3px 8px",transition:"all 0.3s",fontSize:"var(--text-xl)",border:"1px solid var(--color-gray-200)"},"& .MuiOutlinedInput-notchedOutline":{border:"none"},"&:hover .MuiOutlinedInput-notchedOutline":{outline:"none",border:"none"},"& .MuiOutlinedInput-input":{padding:0},"& .MuiInputBase-input":{color:"black",fontSize:"var(--text-lg)",border:"none"}},{icons:i,setResProductAdmin:F,resProductAdmin:L,imgs:le,setSelectPage:ne,setResCategoriesAdmin:_,resCategoriesAdmin:ie,isMobile:y}=De(),[o,de]=s.useState(10),[l,v]=s.useState(1),[A,ce]=s.useState(1),[x,xe]=s.useState(0),[pe,R]=s.useState(0),H=!1,[ue,z]=s.useState(null),g=async(t,r)=>{try{const a=await re(t,r);F(a.data)}catch(a){console.error("Lỗi khi gọi API getProductsPage",a),u.error("Lỗi khi gọi API getProductsPage")}},ge=async()=>{try{const t=await Be();_(t.data)}catch(t){console.error("Lỗi khi gọi API getCategories",t),u.error("Lỗi khi gọi API getCategories"),_([])}};s.useEffect(()=>{g(0,o),v(1),ne("Products"),ge()},[]);const he=()=>{let t=1;l<A&&(t=l+1,v(t));const r=(t-1)*o+1;R(r),g(r,o)},me=()=>{let t=1;l>1&&(t=l-1,v(t));const r=(t-1)*o+1;R(r),g(r,o)},be=async t=>{try{(await Re(t)).data===!0&&(u.success("Delete success"),g(pe,o))}catch(r){console.error("Lỗi khi gọi API deltetProductById",r),u.error("Lỗi khi gọi API deltetProductById")}},fe=t=>{be(t)},je=t=>{t.currentTarget.onerror=null,t.currentTarget.src=le.imgDefault},q=t=>new Date(t).toLocaleDateString("en-US"),ye=t=>{F([]),de(t.target.value),v(1),g(0,t.target.value)},ve=async()=>{try{const t=await ae();if(t.data.length>0){xe(t.data.length);const r=Math.ceil(t.data.length/o);ce(r)}}catch(t){console.error("Lỗi khi gọi API getProducts",t),u.error("Lỗi khi gọi API getProducts")}};s.useEffect(()=>{ve()},[]);const we=async()=>{try{const t=await ae();if(t.data.length>0){const r=D.json_to_sheet(t.data),a=D.book_new();D.book_append_sheet(a,r,"Products");const n=He(a,{bookType:"xlsx",type:"array"}),M=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});ze.saveAs(M,`resProduct_${new Date().toISOString().slice(0,10)}.xlsx`)}else{u.error("There is no data to export to Excel!");return}}catch(t){console.error("Lỗi khi gọi API getProducts",t),u.error("Lỗi khi gọi API getProducts")}},[h,m]=s.useState(""),[w,b]=s.useState(0),[G,S]=s.useState(""),[U,k]=s.useState(0),[T,E]=s.useState([]),[Ne,$]=s.useState(!1),Pe=()=>{$(!0),m(""),b(0),S(""),k(0),E([])},V=()=>$(!1),Ie=t=>{k(Number(t.target.value))},Ce=t=>{const r=t.target.files;if(!r||r.length===0){P("Please choose at least one image");return}P("");const a=[];Array.from(r).forEach(n=>{a.push(new Promise((M,Me)=>{const Y=new FileReader;Y.onload=Z=>{Z.target?.result?M(Z.target.result):Me("Failed to read file")},Y.readAsDataURL(n)}))}),Promise.all(a).then(n=>E(n)).catch(()=>p("Error reading one or more files"))},[N,p]=s.useState(""),[W,P]=s.useState(""),Ae=async t=>{try{const r=t.map(n=>_e(n));return await Promise.all(r)}catch(r){throw console.error("Upload multiple images failed:",r),r}},Se=async t=>{if(t.preventDefault(),p(""),P(""),!T.length){P("Please choose a representative photo");return}const r=await Ae(T),a=U;try{(await Fe({title:h,price:w,description:G,categoryId:a,images:r})).data.title===h?(V(),g(0,o),m(""),b(0),S(""),k(0),E([])):p("Add false")}catch(n){console.error("Error:",n),p("Add false")}},[ke,K]=s.useState(!1),[J,Q]=s.useState(void 0),Te=t=>{const r=L.find(a=>a.id===t);m(r?.title),b(r?.price),Q(t),K(!0)},X=()=>{K(!1),Q(void 0)},Ee=async t=>{t.preventDefault(),p("");try{(await Le(J,{title:h,price:w})).data.id===J?(X(),re(0,o)):p("Edit false")}catch(r){console.error("Error:",r),p("Edit false")}};return e.jsxs(e.Fragment,{children:[e.jsxs("main",{className:"min-h-[77.5vh] p-5 flex flex-col gap-5",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex gap-2 items-center",children:["Show",e.jsxs(ee,{value:o,onChange:ye,className:" w-full",sx:O,MenuProps:B,children:[e.jsx(I,{value:10,children:"10"}),e.jsx(I,{value:15,children:"15"}),e.jsx(I,{value:20,children:"20"})]}),"products"]}),e.jsxs("div",{className:"ml-auto flex gap-2",children:[e.jsx("button",{className:"h-[40px] px-4 bg-orange-700 text-white shadow-lg rounded-[10px]",onClick:Pe,children:y?i.iconAdd:"Add Product"}),e.jsx(te,{open:Ne,onClose:V,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:"absolute top-1/2 left-1/2 flex flex-col gap-4 -translate-x-1/2 -translate-y-1/2 sm:w-[400px] w-[320px] bg-white shadow-lg rounded-[10px] p-5 ",children:[e.jsx("h3",{className:"text-orange-700 text-3xl text-center",children:"Add Product"}),e.jsx("div",{className:"w-full h-[2px] bg-gray-300"}),N&&e.jsx("div",{className:"bg-orange-700/20 border-[1px] border-orange-700/50 shadow-lg items-center mb-3 text-orange-700 text-lg py-1 rounded-[5px]",children:e.jsxs("p",{className:"text-center ",children:[N," !"]})}),e.jsx("form",{className:"space-y-4",onSubmit:Se,children:e.jsxs("div",{className:" flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"title",className:"block text-xl font-medium text-gray-700",children:"Title"}),e.jsx(f,{type:"text",required:!0,autoComplete:"title",placeholder:"title",name:"title",slotProps:{input:{startAdornment:e.jsx(C,{position:"start",children:i.iconTag})}},value:h,variant:"outlined",sx:j,onChange:t=>m(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"price",className:"block text-xl font-medium text-gray-700",children:"Price"}),e.jsx(f,{type:"number",required:!0,autoComplete:"price",placeholder:"Price",name:"price",slotProps:{input:{startAdornment:e.jsx(C,{position:"start",children:i.iconDollar})}},value:w,variant:"outlined",sx:j,onChange:t=>b(Number(t.target.value))})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"description",className:"block text-xl font-medium text-gray-700",children:"Description"}),e.jsx(f,{type:"text",required:!0,autoComplete:"description",placeholder:"Description",name:"description",value:G,variant:"outlined",sx:oe,multiline:!0,minRows:2,maxRows:1/0,onChange:t=>S(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"category",className:"block text-xl font-medium text-gray-700",children:"Categpry"}),e.jsx(ee,{onChange:Ie,sx:O,MenuProps:B,value:U,children:ie.map(t=>e.jsx(I,{value:t.id.toString(),children:t.name},t.id))})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"image",className:"block text-xl font-medium text-gray-700",children:"Image"}),e.jsx("div",{className:"flex items-center w-full relative",children:e.jsxs("label",{htmlFor:"product_file",className:"div-upload-file h-[40px] flex gap-4 items-center justify-center border-[1px] rounded-[10px] border-dashed border-orange-700 cursor-pointer w-full",children:[e.jsx("svg",{className:"w-8 h-8 text-orange-700",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",children:e.jsx("path",{d:"M16.88 9.1A4 4 0 0 1 16 17H5a5 5 0 0 1-1-9.9V7a3 3 0 0 1 4.52-2.59A4.98 4.98 0 0 1 17 8c0 .38-.04.74-.12 1.1zM11 11h3l-4-4-4 4h3v3h2v-3z"})}),e.jsx("span",{className:"text-orange-700",children:"Upload file "}),e.jsx("input",{id:"product_file",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:Ce})]})}),W&&e.jsx("p",{style:{color:"red"},children:W}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:10,marginTop:20},children:T.map((t,r)=>e.jsx("img",{src:t,alt:`preview-${r}`,style:{width:120,height:120,objectFit:"cover",borderRadius:8,border:"1px solid #ddd"}},r))})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-[10px] shadow-sm text-lg font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition duration-200",children:"Add"})})]})})]})}),e.jsx("button",{onClick:we,className:"h-[40px] px-4 text-orange-700 border-[1px] shadow-lg border-orange-700 rounded-[10px]",children:y?i.iconExcel:"Export"})]})]}),e.jsxs("div",{className:"grid",children:[e.jsx("div",{className:"w-full overflow-x-auto scroll-x",children:e.jsxs(qe,{bordered:!0,hover:!0,align:"middle",responsive:!0,className:"w-full border border-gray-300 ",style:{tableLayout:"fixed"},children:[e.jsx(Ge,{color:"light",children:e.jsxs(se,{children:[e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[50px]",children:"ID"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[180px] max-lg:w-[120px]",children:"Title"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[70px]",children:"Price"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 max-xl:w-[200px]",children:"Description"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[110px]",children:"Category"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[70px]",children:"Image"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[110px]",children:"Creation At"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[110px]",children:"Update At"}),e.jsx(d,{className:"text-center bg-orange-200 p-3 text-orange-700 border-[1px] border-gray-200 w-[100px] max-lg:w-[70px]",children:"Action"})]})}),e.jsx(Ue,{children:L.map((t,r)=>e.jsxs(se,{className:"table-body-row-mucluc",onClick:()=>{z(r)},onKeyDown:a=>{a.key==="Enter"&&(a.preventDefault(),z(null))},style:{border:r===ue?"2px dashed rgb(92, 0, 0)":"",cursor:"pointer"},children:[e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200",children:t.id}),e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200",children:t.title}),e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200",children:e.jsxs("span",{className:"text-orange-700  font-bold border-[1px] border-orange-700/20 p-1 bg-orange-700/10 rounded-full",children:["$ ",t.price]})}),e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200 text-justify",children:t.description}),e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200 break-all",children:t.category.name}),e.jsx(c,{className:"p-3 border-[1px] border-gray-200 w-fit",children:e.jsx("div",{className:"grid gap-2 justify-center w-fit",children:t.images.map((a,n)=>e.jsx("img",{src:a,onError:je,className:"w-12 h-12 object-cover rounded",alt:`category ${t.id}`},n))})}),e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200",children:q(t.creationAt)}),e.jsxs(c,{className:"text-center p-3 border-[1px] border-gray-200",children:[" ",q(t.updatedAt)]}),e.jsx(c,{className:"text-center p-3 border-[1px] border-gray-200",children:e.jsxs("div",{className:" flex justify-center max-lg:grid gap-2 p-2",children:[e.jsx("button",{onClick:()=>{Te(t.id)},className:"px-2 py-2 bg-blue-500 text-white shadow-lg transition-all duration-300 ease rounded-[5px] hover:bg-blue-600 hover:shadow-xl",children:i.iconEdit}),e.jsx("button",{onClick:()=>{fe(t.id)},className:"px-2 py-2 bg-red-500 text-white shadow-lg transition-all duration-300 ease rounded-[5px] hover:bg-red-600 hover:shadow-xl",children:i.iconDelete})]})})]},t.id||r))})]})}),e.jsx(te,{open:ke,onClose:X,"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description",children:e.jsxs("div",{className:"absolute top-1/2 left-1/2 flex flex-col gap-4 -translate-x-1/2 -translate-y-1/2 sm:w-[400px] w-[320px] bg-white shadow-lg rounded-[10px] p-5 ",children:[e.jsx("h3",{className:"text-orange-700 text-3xl text-center",children:"Edit Product"}),e.jsx("div",{className:"w-full h-[2px] bg-gray-300"}),N&&e.jsx("div",{className:"bg-orange-700/20 border-[1px] border-orange-700/50 shadow-lg items-center mb-3 text-orange-700 text-lg py-1 rounded-[5px]",children:e.jsxs("p",{className:"text-center ",children:[N," !"]})}),e.jsx("form",{className:"space-y-4",onSubmit:Ee,children:e.jsxs("div",{className:" flex flex-col gap-3",children:[e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"title",className:"block text-xl font-medium text-gray-700",children:"Title"}),e.jsx(f,{type:"text",required:!0,autoComplete:"title",placeholder:"title",name:"title",slotProps:{input:{startAdornment:e.jsx(C,{position:"start",children:i.iconTag})}},value:h,variant:"outlined",sx:j,onChange:t=>m(t.target.value)})]}),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:"price",className:"block text-xl font-medium text-gray-700",children:"Price"}),e.jsx(f,{type:"number",required:!0,autoComplete:"price",placeholder:"Price",name:"price",slotProps:{input:{startAdornment:e.jsx(C,{position:"start",children:i.iconDollar})}},value:w,variant:"outlined",sx:j,onChange:t=>b(Number(t.target.value))})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-[10px] shadow-sm text-lg font-medium text-white bg-orange-600 hover:bg-orange-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-orange-500 transition duration-200",children:"Edit"})})]})})]})})]}),e.jsxs("div",{className:"flex justify-between max-sm:grid gap-2 max-sm:justify-center items-center",children:[e.jsxs("div",{className:"items-center",children:[x===0&&e.jsx("p",{children:"No items displayed"}),x>o*l&&e.jsxs("p",{children:["Showing ",(l-1)*o+1," to ",l*o," of ",x," categories"]}),x<=o*l&&x>0&&e.jsxs("p",{children:["Showing ",(l-1)*o+1," to ",x," of ",x," categories"]})]}),e.jsxs("div",{className:"flex items-center gap-2 max-sm:justify-center",children:[e.jsx("button",{onClick:me,className:"h-[40px] px-2 md:px-4 bg-orange-700 text-white rounded-[10px] shadow-lg disabled:opacity-50",disabled:l===1||H,children:y?i.iconPrev:"Previous"}),e.jsxs("span",{className:"text-page font-medium",children:[l,"/",A]}),e.jsx("button",{onClick:he,className:"h-[40px] px-2 md:px-4 bg-orange-700 text-white rounded-[10px] shadow-lg disabled:opacity-50",disabled:l===A||H,children:y?i.iconNext:"Next"})]})]})]}),e.jsx(Oe,{position:"top-right",autoClose:3e3})]})};export{Qe as default};
